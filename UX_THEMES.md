# UX –°–∏—Å—Ç–µ–º–∞ - –°–≤–µ—Ç–ª–∞—è/–¢—ë–º–Ω–∞—è —Ç–µ–º–∞ + –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —ç–º–æ–¥–∑–∏

–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ —ç–º–æ–¥–∑–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞.

## üåó –¢–µ–º—ã

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–µ–º—ã

| –¢–µ–º–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –≠–º–æ–¥–∑–∏ —Å—Ç–∏–ª—å |
|------|----------|--------------|
| `light` | –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ —ç–º–æ–¥–∑–∏ |
| `dark` | –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —ç–º–æ–¥–∑–∏ |

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã

#### –ö–æ–º–∞–Ω–¥–∞ /theme
```bash
# –í Telegram
/theme
```

#### –ö–Ω–æ–ø–∫–∞ "üåó –¢–µ–º–∞"
- –î–æ—Å—Ç—É–ø–Ω–∞ –≤–æ –≤—Å–µ—Ö –º–µ–Ω—é
- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç —Ç–µ–º—É –æ–¥–Ω–∏–º –Ω–∞–∂–∞—Ç–∏–µ–º
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—ã–±–æ—Ä –≤ –ë–î

## üé® –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —ç–º–æ–¥–∑–∏

### –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ (light)

| –§—É–Ω–∫—Ü–∏—è | –≠–º–æ–¥–∑–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| –ó–∞–º–µ—Ç–∫–∏ | üìù | –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∑–∞–ø–∏—Å–Ω–∞—è –∫–Ω–∏–∂–∫–∞ |
| –î–æ–±–∞–≤–∏—Ç—å | ‚ûï | –ü–ª—é—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è |
| –ó–∞—è–≤–∫–∏ | üõ† | –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã |
| –ú–µ–¥–∏–∞ | üìπ | –í–∏–¥–µ–æ–∫–∞–º–µ—Ä–∞ |
| –†–∞—Å—Å—ã–ª–∫–∞ | üì¢ | –ú–µ–≥–∞—Ñ–æ–Ω |
| –ó–∞–¥–∞–Ω–∏—è | üìã | –ö–ª–∏–ø–±–æ—Ä–¥ |
| –ü—Å–∏—Ö–æ–ª–æ–≥ | üÜò | SOS |

### –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (dark)

| –§—É–Ω–∫—Ü–∏—è | –≠–º–æ–¥–∑–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| –ó–∞–º–µ—Ç–∫–∏ | üìú | –°–≤–∏—Ç–æ–∫ (–±–æ–ª–µ–µ —Ç—ë–º–Ω—ã–π) |
| –î–æ–±–∞–≤–∏—Ç—å | ‚ûï | –ü–ª—é—Å (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) |
| –ó–∞—è–≤–∫–∏ | üîß | –ì–∞–µ—á–Ω—ã–π –∫–ª—é—á |
| –ú–µ–¥–∏–∞ | üé• | –ö–∏–Ω–æ–ø–ª—ë–Ω–∫–∞ |
| –†–∞—Å—Å—ã–ª–∫–∞ | üì¢ | –ú–µ–≥–∞—Ñ–æ–Ω (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) |
| –ó–∞–¥–∞–Ω–∏—è | üìã | –ö–ª–∏–ø–±–æ—Ä–¥ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) |
| –ü—Å–∏—Ö–æ–ª–æ–≥ | üÜò | SOS (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) |
| –¢–µ–º–∞ | ‚òÄÔ∏è | –°–æ–ª–Ω—Ü–µ (–≤–º–µ—Å—Ç–æ üåó) |

## üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ü–æ–ª–µ theme –≤ —Ç–∞–±–ª–∏—Ü–µ users
ALTER TABLE users ADD COLUMN theme VARCHAR DEFAULT 'light';
```

### –ú–æ–¥–µ–ª—å User

```python
# app/db/user.py
class User(Base, TimestampMixin):
    # ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è ...
    theme = Column(String, default="light")  # 'light' | 'dark'
```

## üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã

### –§—É–Ω–∫—Ü–∏—è toggle_theme()

```python
# app/handlers/theme.py
async def toggle_theme(uid: int) -> str:
    async with AsyncSessionLocal() as s:
        user = await s.scalar(select(User).where(User.tg_id == uid))
        new = "dark" if user.theme == "light" else "light"
        await s.execute(update(User).where(User.id == user.id).values(theme=new))
        await s.commit()
        return new
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

```python
@router.message(Command("theme"))
async def cmd_theme(msg: Message, lang: str):
    new = await toggle_theme(msg.from_user.id)
    # –û–±–Ω–æ–≤–ª—è–µ—Ç –º–µ–Ω—é —Å –Ω–æ–≤–æ–π —Ç–µ–º–æ–π

@router.callback_query(lambda c: c.data == "switch_theme")
async def cb_theme(call: CallbackQuery, lang: str):
    new = await toggle_theme(call.from_user.id)
    # –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–µ–∫—É—â–µ–µ –º–µ–Ω—é
```

## üéØ –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å —Ç–µ–º–∞–º–∏

### –§–∞–±—Ä–∏–∫–∞ —ç–º–æ–¥–∑–∏

```python
# app/keyboards/main_menu.py
EMOJI = {
    "light": {
        "teacher_notes": "üìù",
        "teacher_add": "‚ûï",
        # ... –¥—Ä—É–≥–∏–µ —ç–º–æ–¥–∑–∏
    },
    "dark": {
        "teacher_notes": "üìú",
        "teacher_add": "‚ûï",
        # ... –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —ç–º–æ–¥–∑–∏
    },
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–µ–Ω—é

```python
def menu(role: str, lang="ru", theme="light", nonce="") -> InlineKeyboardMarkup:
    e = EMOJI[theme]  # –ü–æ–ª—É—á–∞–µ–º —ç–º–æ–¥–∑–∏ –¥–ª—è —Ç–µ–º—ã
    
    if role == "teacher":
        kb = [
            [InlineKeyboardButton(
                text=f"{e['teacher_notes']} {t('teacher.menu_notes', lang)}",
                callback_data=f"{nonce}:teacher_notes"
            )],
            # ... –¥—Ä—É–≥–∏–µ –∫–Ω–æ–ø–∫–∏
        ]
```

## üåê –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

### –†—É—Å—Å–∫–∏–π (ru.toml)

```toml
[common]
theme_switched = "üåó –¢–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞!"
```

### –ê–Ω–≥–ª–∏–π—Å–∫–∏–π (en.toml)

```toml
[common]
theme_switched = "üåó Theme switched!"
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–¥–∞—á–∞ —Ç–µ–º—ã –≤ –º–µ–Ω—é

```python
# –í–µ–∑–¥–µ, –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è menu()
await m.answer(text, reply_markup=menu(user.role, lang, user.theme))
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ä–æ–ª–µ–π

```python
# –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ä–æ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–µ–º–∞
await call.message.edit_text(
    text,
    reply_markup=menu(role_target, lang, user.theme)
)
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

1. **–ö–æ–º–∞–Ω–¥–∞ /theme**:
   ```bash
   /theme
   ```
   - –≠–º–æ–¥–∑–∏ –º–µ–Ω—è—é—Ç—Å—è
   - –°–æ–æ–±—â–µ–Ω–∏–µ "üåó –¢–µ–º–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞!"

2. **–ö–Ω–æ–ø–∫–∞ "üåó –¢–µ–º–∞"**:
   - –†–∞–±–æ—Ç–∞–µ—Ç –≤ –ª—é–±–æ–º –º–µ–Ω—é
   - –û–±–Ω–æ–≤–ª—è–µ—Ç —Ç–µ–∫—É—â–µ–µ –º–µ–Ω—é

3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î**:
   ```sql
   SELECT theme FROM users WHERE tg_id = YOUR_ID;
   ```

4. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ–ª–µ–π**:
   - –¢–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–æ–ª–∏
   - –≠–º–æ–¥–∑–∏ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –∫ —Ç–µ–º–µ

## üìä –ú–∏–≥—Ä–∞—Ü–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
python manage.py makemigrations "add_user_theme"
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ

```bash
python manage.py migrate
```

### –§–∞–π–ª –º–∏–≥—Ä–∞—Ü–∏–∏

```python
# migrations/versions/003_add_user_theme.py
def upgrade() -> None:
    op.add_column('users', sa.Column('theme', sa.String(), server_default='light'))

def downgrade() -> None:
    op.drop_column('users', 'theme')
```

## üé® –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ç–µ–º

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–µ–º—ã

1. **–î–æ–±–∞–≤–∏—Ç—å —ç–º–æ–¥–∑–∏**:
   ```python
   EMOJI["neon"] = {
       "teacher_notes": "‚ú®",
       "teacher_add": "‚ö°",
       # ... –Ω–æ–≤—ã–µ —ç–º–æ–¥–∑–∏
   }
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å toggle_theme()**:
   ```python
   def get_next_theme(current: str) -> str:
       themes = ["light", "dark", "neon"]
       current_idx = themes.index(current)
       return themes[(current_idx + 1) % len(themes)]
   ```

3. **–î–æ–±–∞–≤–∏—Ç—å –≤ –ë–î**:
   ```sql
   ALTER TABLE users ADD CONSTRAINT check_theme 
   CHECK (theme IN ('light', 'dark', 'neon'));
   ```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è UX —Å–∏—Å—Ç–µ–º—ã:

- ‚úÖ **–û–¥–Ω–æ –Ω–∞–∂–∞—Ç–∏–µ** - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ–Ω—é
- ‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —ç–º–æ–¥–∑–∏** - —Ä–∞–∑–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º
- ‚úÖ **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è** - —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –¥–≤—É—Ö —è–∑—ã–∫–∞—Ö
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Å–µ—Ö —á–∞—Å—Ç—è—Ö –±–æ—Ç–∞
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–µ–º—ã

**UX —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞!** üåó 