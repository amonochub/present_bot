# Context7 –ê–Ω–∞–ª–∏–∑ –ü—Ä–æ–µ–∫—Ç–∞ SchoolBot

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ Python —Ñ–∞–π–ª–æ–≤**: 63
- **–û—à–∏–±–∫–∏ mypy**: 303
- **–û—à–∏–±–∫–∏ ruff**: 166 (115 –∏—Å–ø—Ä–∞–≤–∏–º—ã—Ö)
- **–§–∞–π–ª—ã —Ç—Ä–µ–±—É—é—â–∏–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Black**: 63

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### 1. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ç–∏–ø–æ–≤ (mypy)

#### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLAlchemy)**:
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Base` –∫–ª–∞—Å—Å–∞ –≤ –º–æ–¥–µ–ª—è—Ö
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø–æ–ª–µ–π enum
- –ü—Ä–æ–±–ª–µ–º—ã —Å sessionmaker –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π

**–û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏**:
```python
# app/db/user.py:7: error: Variable "app.db.base.Base" is not valid as a type
# app/db/session.py:17: error: No overload variant of "sessionmaker" matches argument types
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã Base –∫–ª–∞—Å—Å–∞
2. –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é –¥–ª—è enum –ø–æ–ª–µ–π
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π

#### –ü—Ä–æ–±–ª–µ–º—ã —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –≤ handlers:

**app/handlers/onboarding.py**:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ return type annotations
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Optional —Ç–∏–ø–æ–≤
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ Message/CallbackQuery

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**:
```python
# –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é
async def start_onboarding(message: Message, state: FSMContext, lang: str) -> None:
    ...

# –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Optional
if callback.message is not None:
    await callback.message.edit_text(...)
```

### 2. –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ (ruff)

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**–ò–º–ø–æ—Ä—Ç—ã**:
- –ù–µ—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã (I001)
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã (F401)
- –ò–º–ø–æ—Ä—Ç—ã –Ω–µ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞ (E402)

**–î–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏**:
- 101+ —Å–∏–º–≤–æ–ª–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ (E501)
- –û—Å–æ–±–µ–Ω–Ω–æ –≤ —Ñ–∞–π–ª–∞—Ö: `app/handlers/onboarding.py`, `app/keyboards/main_menu.py`

**–ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**:
- –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `e` –≤ exception handlers
- –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π

#### –ò—Å–ø—Ä–∞–≤–∏–º—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (115 –∏–∑ 166):
```bash
python3 -m ruff check app/ --fix
```

### 3. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ (Black)

**–í—Å–µ 63 —Ñ–∞–π–ª–∞ —Ç—Ä–µ–±—É—é—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç—Å—Ç—É–ø—ã
- –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–∞–≤—ã—á–µ–∫
- –î–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

**–†–µ—à–µ–Ω–∏–µ**:
```bash
python3 -m black app/
```

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**:
   ```python
   # app/db/base.py
   from sqlalchemy.ext.declarative import declarative_base
   Base = declarative_base()
   
   # –í –º–æ–¥–µ–ª—è—Ö
   class User(Base):
       __tablename__ = "users"
       # –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
   ```

2. **–î–æ–±–∞–≤–∏—Ç—å return type annotations**:
   ```python
   # –í–æ –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
   async def handler(message: Message) -> None:
       ...
   ```

3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É Optional —Ç–∏–ø–æ–≤**:
   ```python
   # –í–º–µ—Å—Ç–æ
   message.edit_text(...)
   
   # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
   if message is not None:
       await message.edit_text(...)
   ```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

1. **–û—á–∏—Å—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã**:
   ```bash
   python3 -m ruff check app/ --fix
   ```

2. **–û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥**:
   ```bash
   python3 -m black app/
   ```

3. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏**:
   - –†–∞–∑–±–∏—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –≤ `app/handlers/onboarding.py`
   - –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Å–ª–æ–∂–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –≤ `app/keyboards/main_menu.py`

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

1. **–£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**
2. **–î–æ–±–∞–≤–∏—Ç—å docstrings**
3. **–£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫**

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –¢–∏–ø–∏–∑–∞—Ü–∏—è:
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π**: ~30%
- **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏**: 45
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è**: 258

### –°—Ç–∏–ª—å –∫–æ–¥–∞:
- **–§–∞–π–ª—ã —Å –æ—à–∏–±–∫–∞–º–∏ —Å—Ç–∏–ª—è**: 63/63 (100%)
- **–ò—Å–ø—Ä–∞–≤–∏–º—ã–µ –æ—à–∏–±–∫–∏**: 115/166 (69%)
- **–î–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏**: 25+ —Ñ–∞–π–ª–æ–≤

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: ‚úÖ –•–æ—Ä–æ—à–∞—è
- **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: ‚úÖ –•–æ—Ä–æ—à–µ–µ
- **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: ‚úÖ –•–æ—Ä–æ—à–µ–µ

## üõ†Ô∏è –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–∞—Ü–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
2. –î–æ–±–∞–≤–∏—Ç—å return type annotations
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É Optional —Ç–∏–ø–æ–≤

### –≠—Ç–∞–ø 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1 –¥–µ–Ω—å)
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å `ruff --fix`
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `black`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –≠—Ç–∞–ø 3: –†—É—á–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (2-3 –¥–Ω—è)
1. –†–∞–∑–±–∏—Ç—å –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
2. –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–º–ø–æ—Ä—Ç—ã
3. –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–∏–ø—ã

### –≠—Ç–∞–ø 4: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (1 –¥–µ–Ω—å)
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

## üìã –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pre-commit hooks**:
   ```yaml
   # .pre-commit-config.yaml
   repos:
     - repo: https://github.com/psf/black
       rev: 23.12.1
       hooks:
         - id: black
     - repo: https://github.com/astral-sh/ruff-pre-commit
       rev: v0.1.6
       hooks:
         - id: ruff
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å IDE**:
   - –í–∫–ª—é—á–∏—Ç—å mypy –≤ IDE
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å auto-formatting
   - –î–æ–±–∞–≤–∏—Ç—å linting rules

3. **–°–ª–µ–¥–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º**:
   - PEP 8 –¥–ª—è —Å—Ç–∏–ª—è
   - PEP 484 –¥–ª—è —Ç–∏–ø–∏–∑–∞—Ü–∏–∏
   - Black –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –î–ª—è CI/CD:

1. **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤ pipeline**:
   ```yaml
   # .github/workflows/ci.yml
   - name: Type check
     run: python -m mypy app/
   
   - name: Lint
     run: python -m ruff check app/
   
   - name: Format check
     run: python -m black --check app/
   ```

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö —É–ª—É—á—à–µ–Ω–∏–π –≤ –æ–±–ª–∞—Å—Ç–∏ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ –∏ —Å—Ç–∏–ª—è –∫–æ–¥–∞. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å–≤—è–∑–∞–Ω—ã —Å:

1. **–ù–µ–ø–æ–ª–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π** (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö)
2. **–ù–∞—Ä—É—à–µ–Ω–∏—è–º–∏ —Å—Ç–∏–ª—è –∫–æ–¥–∞** (–∏–º–ø–æ—Ä—Ç—ã, —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º return type annotations**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º Python —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å—Ç–∞–Ω–µ—Ç –±–æ–ª–µ–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º.

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞**: 6/10
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**: –í—ã—Å–æ–∫–∏–π
**–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: 5-7 –¥–Ω–µ–π 