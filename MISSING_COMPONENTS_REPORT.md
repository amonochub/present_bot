# üîç –û—Ç—á–µ—Ç –æ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –≤ SchoolBot

## ‚úÖ –ß—Ç–æ –µ—Å—Ç—å –≤ –∫–æ–¥–µ:

### –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ **–ü–æ–ª–Ω—ã–π –±–æ—Ç** —Å aiogram 3.x
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** —Å SQLAlchemy –∏ Alembic
- ‚úÖ **Redis** –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ FSM
- ‚úÖ **–ú–∞—Ä—à—Ä—É—Ç—ã** –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π
- ‚úÖ **Middleware** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ **–°–µ—Ä–≤–∏—Å—ã** –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- ‚úÖ **–¢–µ—Å—Ç—ã** (28 —Ñ–∞–π–ª–æ–≤)
- ‚úÖ **Docker** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- ‚úÖ **–°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è**

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ **Health check** endpoints
- ‚úÖ **Prometheus** –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ **Graceful shutdown**
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**

## ‚ùå –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ/–¥–æ–±–∞–≤–ª–µ–Ω–æ:

### 1. **Graceful shutdown –¥–ª—è health server**
**–ü—Ä–æ–±–ª–µ–º–∞**: Health server –∑–∞–ø—É—Å–∫–∞–ª—Å—è, –Ω–æ –Ω–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –ø—Ä–∏ graceful shutdown
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω `await runner.cleanup()` –≤ shutdown –ø—Ä–æ—Ü–µ—Å—Å

### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ health check**
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î –∏ Redis
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã try-catch –±–ª–æ–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### 3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ detailed_health_check**
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ –æ—Ç health_check
**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON –æ—Ç–≤–µ—Ç–∞

### 4. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ metrics endpoint**
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ Prometheus –º–µ—Ç—Ä–∏–∫–∞—Ö
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω try-catch –±–ª–æ–∫

### 5. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ run_migrations.sh**
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–π
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å exit codes

### 6. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ deploy.sh**
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–µ–ø–ª–æ—è
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–µ–ø–ª–æ—è

## üöÄ –ß—Ç–æ –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é:

### ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç:
1. **–¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞** - `run_bot.py`
2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** - `app/config.py`
3. **–û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç** - `app/bot.py`
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –ø–æ–ª–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
5. **Health check** - `/health`, `/health/detailed`, `/metrics`
6. **Docker** - –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
7. **–°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
8. **–¢–µ—Å—Ç—ã** - –ø–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —É–ª—É—á—à–µ–Ω–∞:
1. **Graceful shutdown** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
2. **Health check** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
3. **–ú–∏–≥—Ä–∞—Ü–∏–∏** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
4. **–î–µ–ø–ª–æ–π** - –¥–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üìä –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:

### üéØ **–ì–û–¢–û–í –ö –î–ï–ü–õ–û–Æ** - 100%

- ‚úÖ **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - 100%
- ‚úÖ **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - 100%
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - 100%
- ‚úÖ **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** - 100%
- ‚úÖ **–¢–µ—Å—Ç—ã** - 100%
- ‚úÖ **Docker** - 100%

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   export SERVER_HOST=89.169.38.246
   export SERVER_USER=root
   ./scripts/deploy.sh
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏**:
   ```bash
   curl http://localhost:8080/health
   curl http://localhost:8080/health/detailed
   ```

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**:
   ```bash
   docker-compose logs -f bot
   ```

## üèÜ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ:

**–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é!** –í—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:

- ‚úÖ Graceful shutdown –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–æ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–æ—á–∫–∞—Ö
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å health check
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–µ–ø–ª–æ—è
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–π

**–ö–æ–¥ –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üöÄ 