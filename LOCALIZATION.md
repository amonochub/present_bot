# üåê –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è SchoolBot

## –û–±–∑–æ—Ä

–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ TOML-—Ñ–∞–π–ª—ã. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º Telegram.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
app/i18n/
‚îú‚îÄ‚îÄ __init__.py    # –£—Ç–∏–ª–∏—Ç—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ ru.toml        # –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
‚îî‚îÄ‚îÄ en.toml        # –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–¥–µ

```python
from app.i18n import t

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏
message = t("common.start_welcome", lang)  # lang = "ru" –∏–ª–∏ "en"

# –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
message = t("teacher.ticket_created", lang).format(ticket_id=123)
```

### –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö

```python
@router.callback_query(F.data == "teacher_notes")
async def teacher_notes(call: CallbackQuery, lang: str):
    await call.message.edit_text(
        t("teacher.notes_empty", lang),
        reply_markup=menu("teacher", lang)
    )
```

## –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `ru.toml` ‚Üí `es.toml`
2. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏
3. –û–±–Ω–æ–≤–∏—Ç–µ `LocaleMiddleware` –≤ `app/middlewares/locale.py`:

```python
if lang not in ("ru", "en", "es"):  # –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–π –∫–æ–¥
    lang = self.default
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ TOML-—Ñ–∞–π–ª–æ–≤

```toml
[common]
start_welcome = "üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ SchoolBot!\n–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω:"
auth_success = "‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!"

[teacher]
menu_notes = "üìù –ú–æ–∏ –∑–∞–º–µ—Ç–∫–∏"
menu_add = "‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É"

[student]
menu_notes = "üìù –ú–æ–∏ –∑–∞–º–µ—Ç–∫–∏"
# ...
```

## –°–µ–∫—Ü–∏–∏

- `common` - –æ–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –æ—à–∏–±–∫–∏)
- `teacher` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É—á–∏—Ç–µ–ª—è
- `student` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É—á–µ–Ω–∏–∫–∞
- `parent` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ä–æ–¥–∏—Ç–µ–ª—è
- `psych` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Å–∏—Ö–æ–ª–æ–≥–∞
- `admin` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `director` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞
- `errors` - —Å–∏—Å—Ç–µ–º–Ω—ã–µ –æ—à–∏–±–∫–∏

## Middleware

`LocaleMiddleware` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è Telegram
- –î–æ–±–∞–≤–ª—è–µ—Ç `lang` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- Fallback –Ω–∞ —Ä—É—Å—Å–∫–∏–π –¥–ª—è –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —è–∑—ã–∫–æ–≤

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

–§–∞–π–ª—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏. –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```python
from app.i18n import clear_cache
clear_cache()  # –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
python3 -c "from app.i18n import t; print(t('common.start_welcome', 'en'))"
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ö–ª—é—á–∏**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–µ—Ä–∞—Ä—Ö–∏—é `section.key`
2. **–≠–º–æ–¥–∑–∏**: —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —ç–º–æ–¥–∑–∏ –≤ –ø–µ—Ä–µ–≤–æ–¥–∞—Ö
3. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.format()` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
4. **Fallback**: –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞
5. **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ñ—Ä–∞–∑—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–ª—é—á–∏
