# üåç –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è School Bot

## üìã –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

School Bot –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ TOML —Ñ–∞–π–ª–æ–≤. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —è–∑—ã–∫–µ.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
app/i18n/
‚îú‚îÄ‚îÄ __init__.py          # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ en.toml             # –ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫
‚îî‚îÄ‚îÄ ru.toml             # –†—É—Å—Å–∫–∏–π —è–∑—ã–∫
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã
1. **–ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞**: —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —è–∑—ã–∫ –∏–∑ Telegram
2. **Fallback –º–µ—Ö–∞–Ω–∏–∑–º**: –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä—É—Å—Å–∫–∏–π
3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ø–µ—Ä–µ–≤–æ–¥—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
4. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ hot-reload –ø–µ—Ä–µ–≤–æ–¥–æ–≤

## üìù –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ TOML —Ñ–∞–π–ª–∞
```toml
# app/i18n/ru.toml
[common]
start = "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ School Bot! üéì"
help = "–ü–æ–º–æ—â—å –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –±–æ—Ç–∞"
rate_limited = "–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."

[roles]
student = "–£—á–µ–Ω–∏–∫"
teacher = "–£—á–∏—Ç–µ–ª—å"
parent = "–†–æ–¥–∏—Ç–µ–ª—å"
director = "–î–∏—Ä–µ–∫—Ç–æ—Ä"
admin = "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä"

[errors]
not_found = "–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
permission_denied = "–£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è"
invalid_input = "–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö"
```

### –ü—Ä–∞–≤–∏–ª–∞ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –∫–ª—é—á–µ–π
- **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**: `section.subsection.key`
- **–û–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞**: `user.profile.updated`
- **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å**: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∫–ª—é—á–∏ –≤–æ –≤—Å–µ—Ö —è–∑—ã–∫–∞—Ö
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞**: –ª–æ–≥–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### 1. **–ò–º–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–≤–æ–¥–∞**
```python
from app.i18n import t

# –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–≤–æ–¥
message = t("common.start", lang)

# –ü–µ—Ä–µ–≤–æ–¥ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
message = t("user.welcome", lang, name=user.name)
```

### 2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
```python
from app.middlewares.locale import get_user_language

# –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ
async def some_handler(message: Message, user: User):
    lang = get_user_language(user)
    response = t("common.help", lang)
    await message.answer(response)
```

### 3. **–†–∞–±–æ—Ç–∞ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞–º–∏**
```python
from app.keyboards.main_menu import get_main_menu

async def show_main_menu(message: Message, user: User):
    lang = get_user_language(user)
    keyboard = get_main_menu(lang)
    await message.answer(t("menu.main", lang), reply_markup=keyboard)
```

## üìö –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —è–∑—ã–∫–∞

### 1. **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–≤–æ–¥–∞**
```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–π–ª
touch app/i18n/en.toml
```

### 2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞**
```toml
# app/i18n/en.toml
[common]
start = "Welcome to School Bot! üéì"
help = "Help on bot usage"
rate_limited = "Too many requests. Try again later."

[roles]
student = "Student"
teacher = "Teacher"
parent = "Parent"
director = "Director"
admin = "Administrator"

[errors]
not_found = "Requested information not found"
permission_denied = "You don't have permission to perform this action"
invalid_input = "Invalid data format"
```

### 3. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —è–∑—ã–∫–∞**
```python
# app/i18n/__init__.py
SUPPORTED_LANGUAGES = {
    "ru": "–†—É—Å—Å–∫–∏–π",
    "en": "English",
    # –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —è–∑—ã–∫
    "es": "Espa√±ol"
}
```

### 4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ middleware**
```python
# app/middlewares/locale.py
async def get_user_language(user: User) -> str:
    """–ü–æ–ª—É—á–∏—Ç—å —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
    if user.language in SUPPORTED_LANGUAGES:
        return user.language
    return "ru"  # Fallback –Ω–∞ —Ä—É—Å—Å–∫–∏–π
```

## üõ†Ô∏è Best Practices

### 1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç**
```python
# ‚ùå –ü–ª–æ—Ö–æ
await message.answer("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!")

# ‚úÖ –•–æ—Ä–æ—à–æ
await message.answer(t("common.welcome", lang))
```

### 2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã–µ –∫–ª—é—á–∏**
```python
# ‚ùå –ü–ª–æ—Ö–æ
t("welcome_message", lang)
t("greeting", lang)

# ‚úÖ –•–æ—Ä–æ—à–æ
t("common.welcome", lang)
t("common.greeting", lang)
```

### 3. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—ã**
```toml
# ‚úÖ –•–æ—Ä–æ—à–æ
[user]
profile = "–ü—Ä–æ—Ñ–∏–ª—å"
settings = "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
logout = "–í—ã–π—Ç–∏"

[task]
create = "–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É"
edit = "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É"
delete = "–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É"
```

### 4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞**
```python
# –í –∫–æ–¥–µ
message = t("task.assigned", lang, task=task.title, user=user.name)

# –í TOML
task.assigned = "–ó–∞–¥–∞—á–∞ '{task}' –Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {user}"
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**
```bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
python scripts/check_translations.py
```

### 2. **–†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞**
```python
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –∫–ª—é—á–∏
from app.i18n import check_translations

missing_keys = check_translations()
if missing_keys:
    print("Missing translations:", missing_keys)
```

### 3. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã**
```python
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É TOML —Ñ–∞–π–ª–æ–≤
import tomllib

def validate_toml_structure():
    with open("app/i18n/ru.toml", "rb") as f:
        data = tomllib.load(f)
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

### –¢–µ–∫—É—â–∏–µ —è–∑—ã–∫–∏:
- **–†—É—Å—Å–∫–∏–π (ru)**: 100% –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–ê–Ω–≥–ª–∏–π—Å–∫–∏–π (en)**: 85% –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–ò—Å–ø–∞–Ω—Å–∫–∏–π (es)**: 60% –ø–æ–∫—Ä—ã—Ç–∏–µ (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

### –ö–ª—é—á–µ–≤—ã–µ —Å–µ–∫—Ü–∏–∏:
- `common`: 50 –∫–ª—é—á–µ–π
- `roles`: 5 –∫–ª—é—á–µ–π
- `errors`: 15 –∫–ª—é—á–µ–π
- `menu`: 30 –∫–ª—é—á–µ–π
- `tasks`: 25 –∫–ª—é—á–µ–π
- `notes`: 20 –∫–ª—é—á–µ–π

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
# –Ø–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
DEFAULT_LANGUAGE=ru

# –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —è–∑—ã–∫–∏
SUPPORTED_LANGUAGES=ru,en,es

# –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
AUTO_DETECT_LANGUAGE=true
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∫–æ–¥–µ:
```python
# app/config.py
class Config:
    DEFAULT_LANGUAGE: str = "ru"
    SUPPORTED_LANGUAGES: List[str] = ["ru", "en", "es"]
    AUTO_DETECT_LANGUAGE: bool = True
```

## üöÄ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**
```python
# –ü–µ—Ä–µ–≤–æ–¥—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏
_translation_cache = {}

def get_translation(key: str, lang: str) -> str:
    cache_key = f"{lang}:{key}"
    if cache_key not in _translation_cache:
        _translation_cache[cache_key] = load_translation(key, lang)
    return _translation_cache[cache_key]
```

### 2. **Lazy Loading**
```python
# –ü–µ—Ä–µ–≤–æ–¥—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
def load_translation(key: str, lang: str) -> str:
    if lang not in _loaded_languages:
        _loaded_languages[lang] = load_language_file(lang)
    return _loaded_languages[lang].get(key, key)
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤

### 1. **Hot Reload**
```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ñ–∞–π–ª–æ–≤
def reload_translations():
    global _loaded_languages
    _loaded_languages.clear()
    _translation_cache.clear()
```

### 2. **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**
```python
# –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–æ–≤
TRANSLATION_VERSION = "1.0.0"

def get_translation_version() -> str:
    return TRANSLATION_VERSION
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–æ–≤

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- [ ] –í—Å–µ –∫–ª—é—á–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤–æ –≤—Å–µ—Ö —è–∑—ã–∫–∞—Ö
- [ ] –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–æ–¥–µ
- [ ] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ø–µ—Ä–µ–≤–æ–¥–∞—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –∫–æ–¥—É
- [ ] –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ –∏ –ø—É–Ω–∫—Ç—É–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- [ ] –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–µ—Ä–µ–≤–æ–¥–∞ –ø–æ–Ω—è—Ç–µ–Ω

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞
- [ ] –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–æ—Å–∏—Ç–µ–ª—è–º–∏ —è–∑—ã–∫–∞
- [ ] –£—á–∏—Ç—ã–≤–∞—Ç—å –∫—É–ª—å—Ç—É—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: $(date)  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ
